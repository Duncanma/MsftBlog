
{{~setProp this 'grid' (evaluate grid '||' (object))~}}


{{!-- Define grid layout HTML tag being used --}}
{{setProp grid 'layout-html-tag' 'div'}}

{{#if carousel}}
  {{!-- Define carousel padding --}}
  {{setProp this 'classes' 'py-5 mx-n2'}}
{{else}}
  {{!-- Define grid layout HTML tag being used; >= 3 products, use unordered list --}}
  {{#if (evaluate this.products.length '>' 2)}}
    {{setProp grid 'layout-html-tag' 'ul'}}
    {{setProp this 'classes' 'list-unstyled my-0 mx-n2'}}
  {{/if}}
{{/if}}


{{!-- Define row classes --}}
{{#if devices}}
  {{setProp grid 'row-cols' (array '2' 'sm-3' 'md-4' 'lg-5')}}
{{else}}
  {{setProp grid 'row-cols' (array '2' 'sm-3' 'md-4' 'lg-6')}}
{{/if}}

{{!-- Card grid section heading--}}
{{#if section}}
<section {{#if section.attributes}}{{{htmlAttr section.attributes}}}{{/if}}>
{{#if section.heading}}
  {{render '@headings' section.heading}}
{{/if}}
{{/if}}

{{!-- Card grid layout template --}}
{{#> '@card-layout--grid' this}}
  {{#*inline 'cards'}}
    {{#each products}}

      {{!-- Define card HTML tag being used; >= 3 products, use list item --}}
      {{setProp this 'card-html-tag' 'div'}}

      {{!-- Set card margin by type and number of products --}}
      {{#unless ../carousel}}

        {{!-- Define default card column classes --}}
        {{setProp this 'column-classes' 'mb-4 px-2'}}

        {{!-- Define card HTML tag being used; >= 3 products, use list item --}}
        {{#if (evaluate @root.products.length '>' 2)}}
          {{setProp this 'card-html-tag' 'li'}}
        {{/if}}
      {{else}}
        {{setProp this 'column-classes' 'slide-item px-2'}}
      {{/unless}}

      {{!-- Product card template --}}
      {{ render handle this merge=true }}
    {{/each}}
  {{/inline}}
{{/'@card-layout--grid'}}

{{!-- Closing section heading --}}
{{#if section}}
</section>
{{/if}}
