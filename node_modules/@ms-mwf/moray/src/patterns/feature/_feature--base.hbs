{{!-- Define variables --}}
{{~setVar 'cardClasses' (array 'd-block')~}}
{{~setVar 'rowClasses' (array 'no-gutters')~}}
{{~setVar 'contentColClasses' (array 'd-flex')~}}

{{~#unless carousel~}}
  {{~push (getVar 'cardClasses') 'mx-ng mx-md-0'~}}
{{~/unless~}}

{{!-- Define background or border --}}
{{~#if border~}}
  {{~push (getVar 'rowClasses') 'border'~}}
{{~else~}}
  {{~push (getVar 'rowClasses') 'material-surface'~}}
{{~/if~}}

{{!-- Define color scheme --}}
{{~#if color-scheme~}}
  {{~push (getVar 'rowClasses') (strConcat 'material-color-' color-scheme)~}}
  {{~setProp content.body.templates.[0].data 'color-scheme' color-scheme~}}
{{~/if~}}

{{!-- Define content alignment --}}
{{~#ifCond content.alignment '==' 'center'~}}
  {{~push (getVar 'rowClasses') 'justify-content-center'~}}
{{~/ifCond~}}
{{~#ifCond content.alignment '==' 'left'~}}
  {{~push (getVar 'contentColClasses') 'order-md-first'~}}
{{~/ifCond~}}

{{!-- Define image and content column widths by image size --}}
{{!-- no image --}}
{{#unless image}}
  {{~push (getVar 'contentColClasses') 'col-md-6'~}}
{{/unless}}
{{!-- small image --}}
{{~#ifCond image.size '==' 'sm'~}}
  {{~setProp ../image 'col-classes' 'col-md-5 col-lg-4'~}}
  {{~push (getVar 'contentColClasses') 'col-md'~}}
{{~/ifCond~}}
{{!-- 1:1 image --}}
{{~#ifCond image.size '==' 'md'~}}
  {{~setProp ../image 'col-classes' 'col-md-6'~}}
  {{~push (getVar 'contentColClasses') 'col-md'~}}
{{~/ifCond~}}
{{!-- large image (feature with mini features) --}}
{{~#ifCond image.size '==' 'lg'~}}
  {{~setProp ../image 'col-classes' 'col-md-7'~}}
  {{~push (getVar 'contentColClasses') 'col-md'~}}
{{~/ifCond~}}
{{!-- 1:2 x-large image --}}
{{~#ifCond image.size '==' 'xl'~}}
  {{~setProp ../image 'col-classes' 'col-md-8'~}}
  {{~push (getVar 'contentColClasses') 'col-md'~}}
{{~/ifCond~}}

{{!-- Define image styles --}}
{{~#if image.cover~}}
  {{~setProp image.image 'classes' 'img-object-cover'~}}
{{~/if~}}

{{!-- Define card body classes --}}
{{!-- Most variants have pretty unique padding that don't seem related to anything else so we're allowing any classes to be passed in. --}}
{{~#if content.body.classes~}}
  {{~#unless (contains content.body.classes 'align-self-center')~}}
    {{~setProp content.body 'classes' (math 'align-self-center ' '+' content.body.classes)~}}
  {{~/unless~}}
{{~else~}}
  {{~setProp content.body 'classes' 'align-self-center'~}}
{{~/if~}}

{{!-- Mini features --}}
{{~#if mini-features~}}
  {{~push (getVar 'cardClasses') 'mb-g mb-md-4'~}}
{{~/if~}}

{{!-- Assign props --}}
{{~setProp this 'classes' (join (getVar 'cardClasses') ' ')~}}
{{~setProp this 'row-classes' (join (getVar 'rowClasses') ' ')~}}
{{~setProp content 'col-classes' (join (getVar 'contentColClasses') ' ')~}}

{{!-- Assign left and right --}}
{{~#if image.first-in-dom~}}
  {{~setProp this 'left' image~}}
  {{~setProp this 'right' content~}}
{{~else~}}
  {{~setProp this 'left' content~}}
  {{~setProp this 'right' image~}}
{{~/if~}}

{{!-- Horizontal card template --}}
{{#> '@card--horizontal' this}}
  {{#* inline 'image'}}
    {{#if ../video-trigger}}
      {{> '@images--full-width-picture-element'}}
      {{render '@play-video' ../video-trigger.icon}}
    {{else}}
      {{> '@images--full-width-picture-element'}}
    {{/if}}
  {{/inline}}
{{/'@card--horizontal'}}

{{#if video-trigger}}
  {{#> @modal id=video-trigger.modal.id button=false body=false footer=false}}
    {{#*inline "body-partial"}}
      Embed third-party video player here.
    {{/inline}}
  {{/@modal}}
{{/if}}
