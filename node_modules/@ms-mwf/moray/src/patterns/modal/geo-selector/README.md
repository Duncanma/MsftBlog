The Geo-Selector is a [Modal]({{ internalLink '/components/detail/modal' }}) that pops up when the site detects that the user may be in the wrong market and offers to take them to the detected market. It uses a [ContentSwap]({{ internalLink '/components/detail/content-swap' }}) to enable client-slide language switching between the current and detected language, if applicable.

The **only** authorable fields in these templates are:
- Text nodes (Required)
- `aria-label` localization for the Modal close buttons (Required)
- `lang` and `dir` attributes (Required if language or writing direction of an element differs from that of current page)
- `href` attribute of link to detected market (Required)
- `hreflang` attribute of link to detected market (Required if pointing to a site that is in a different language than current page)

**All** other attributes, classes, and mark-up is required to achieve appropriate styling and functionality.

## Example html

### Different Languages

When the language of the current and detected market are different, the following format should be used to enable client-side translation of the modal content.

```html
<div data-mount="modal" class="modal fade" id="geo-selector-modal" tabindex="-1" role="dialog" aria-labelledby="modal-label-id" aria-hidden="true">
  <div class="modal-dialog  modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close geo-selector-localized-copy" data-dismiss="modal" aria-label="Close dialog window" lang="en"></button>
        <button type="button" class="close geo-selector-localized-copy" data-dismiss="modal" aria-label="Fermer le fiche de dialog" hidden></button>
      </div>
      <div class="modal-body">
        <button data-mount="content-swap" data-target=".geo-selector-localized-copy" class="action-trigger mb-2">
          <span class="geo-selector-localized-copy">Traduire en Français</span>
          <span class="geo-selector-localized-copy" hidden lang="en">Translate to English</span>
        </button>
        <h2 class="h3" id="modal-label-id">
          <span class="geo-selector-localized-copy" lang="en">You are visiting the Microsoft Store in Canada - French</span>
          <span class="geo-selector-localized-copy" hidden>Vous visitez le Microsoft Store au Canada - Français</span>
        </h2>
        <div class="geo-selector-localized-copy">
          <p lang="en">Do you want to browse in Canada - English?</p>
        </div>
        <div class="geo-selector-localized-copy" hidden>
          <p>Voulez-vous accéder au site Canada - Anglais?</p>
        </div>
      </div>
      <div class="modal-footer pb-5">
        <div class="container px-0 w-100">
          <div class="row geo-selector-localized-copy">
            <div class="col-12 col-md-6 mb-3">
              <button class="btn btn-primary btn-block" data-dismiss="modal" lang="en">Stay in Canada - French</button>
            </div>
            <div class="col-12 col-md-6 mb-3">
              <a href="#" class="btn btn-primary btn-block" lang="en" hreflang="en">Go to Canada - English</a>
            </div>
          </div>
          <div class="row geo-selector-localized-copy" hidden>
            <div class="col-12 col-md-6 mb-3">
              <button class="btn btn-primary btn-block" data-dismiss="modal">Rester au Canada - Français</button>
            </div>
            <div class="col-12 col-md-6 mb-3">
              <a href="#" class="btn btn-primary btn-block" hreflang="en">Accéder au Canada - Anglais</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
```

### Same Language

When the langauge of the current and detected market are the same, the following template should be used:

```html
<div class="modal fade" id="geo-selector-modal" tabindex="-1" role="dialog" aria-labelledby="modal-label-id"  aria-hidden="true">
  <div class="modal-dialog  modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close geo-selector-localized-copy" data-dismiss="modal" aria-label="Close dialog window"></button>
      </div>
      <div class="modal-body">
        <h2 class="h3" id="modal-label-id"> You are visiting the Microsoft Store in United States - English</h2>
        <p>Do you want to browse in Canada - English?</p>
      </div>
      <div class="modal-footer pb-5">
        <div class="container px-0 w-100">
          <div class="row">
            <div class="col-12 col-md-6 mb-3">
              <button class="btn btn-primary btn-block" data-dismiss="modal">Stay in United States - English</button>
            </div>
            <div class="col-12 col-md-6 mb-3">
              <a href="#" class="btn btn-primary btn-block">Go to Canada - English</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
```

## Considerations for Same-Language Geo-Selector

### Triggering the Geo-Selector
Modals can currently be triggered programmatically through the modal class, for example:

```js
var instance = new mwf.Modal({modal: document.querySelector('#geo-selector-modal')});
instance.show();
```
There is no need to include a trigger element such as a button. However, since there is no triggering element to which to return focus when a keyboard user closes the modal, be advised that focus is returned to the page based on where the modal is in the page, so it is recommended to place it before all page content.


### The Header

Note that the header that labels the dialog in the `.modal-body` section instead of the `.modal-header` as follows:
```html
<div class="modal-header">
  <button type="button" class="close geo-selector-localized-copy" data-dismiss="modal" aria-label="Close dialog window"></button>
</div>
<div class="modal-body">
  <h2 class="h3" id="modal-label"> You are visiting the Microsoft Store in United States - English</h2>
  <p>Do you want to browse in Canada - English?</p>
</div>
```

### The Footer
The `.modal-footer` section contains the two button-style elements within a grid:
```html
<div class="modal-footer pb-5">
  <div class="container px-0 w-100">
    <div class="row">
      <div class="col-12 col-md-6 mb-3">
        <button class="btn btn-primary btn-block" data-dismiss="modal">Stay in United States - English</button>
      </div>
      <div class="col-12 col-md-6 mb-3">
        <a href="#" class="btn btn-primary btn-block">Go to Canada - English</a>
      </div>
    </div>
  </div>
</div>
```

The grid is set up so that the buttons are side-by-side at viewports `md` and larger, but vertically stacked at smaller viewports. They should span the width of the content area of the Modal.

### The Stay Button
```html
<button class="btn btn-primary btn-block" data-dismiss="modal">Stay in United States - English</button>
```

The first button is a `<button>` which dismisses the Modal. It is recommended that the site records this action as a user preference. Information about hooking into Modal events can be found in the Bootstrap documentation for [Modals](https://getbootstrap.com/docs/4.4/components/modal/#events)

### The Leave Link
```html
<a href="#" class="btn btn-primary btn-block">Go to Canada - English</a>
```

The second button is a button-styled `<a>`, which should point to the detected market.

## Considerations for Different-Language Geo-Selector

All of the considerations for the Same-Language Geo-Selector apply, as well as the following:

### The Content Swap
```html
<button data-mount="content-swap" data-target=".geo-selector-localized-copy" class="action-trigger mb-2">
  <span class="geo-selector-localized-copy">Traduire en Français</span>
  <span class="geo-selector-localized-copy" hidden lang="en">Translate to English</span>
</button>
```

For background on the Content Swap component, see documentation on its [own page]({{ internalLink '/components/detail/content-swap' }})

The purpose of this Content Swap instance is to allow users to switch the language of the Geo Selector between the detected language and the language of the current page using the translator button above. In this example, the detected language is shown by default, with the exception of the translator button itself, where the language of the current page is shown by default instead.

Note that the `<button>` above has two `<span>`s inside with each language. This is so that when keyboard users activate the button, keyboard focus stays on the translator button. Another similar case is the `<h2>` element, so that the `aria-labelledby` attribute of the modal works in both languages:

```html
<div class="modal fade" id="geo-selector-modal" tabindex="-1" role="dialog" aria-labelledby="modal-label-id" aria-hidden="true">
  ...
        <h2 class="h3" id="modal-label-id">
          <span class="geo-selector-localized-copy" lang="en">You are visiting the Microsoft Store in Canada - French</span>
          <span class="geo-selector-localized-copy" hidden>Vous visitez le Microsoft Store au Canada - Français</span>
        </h2>
  ...
</div>
```


### `lang` Attributes

```html
<button class="btn btn-primary btn-block" data-dismiss="modal" lang="en">Stay in Canada - French</button>
```

When presenting content in a language that is different than the overall page, it must be marked with what language it is in using the `lang` attribute so that screen readers narrate the text correctly. In this example, English content is presented on a French page, so it is marked with `lang="en"`.

All elements that are in a different language must have a `lang` attribute, even if they are narrated only, like the modal close button:
```html
<button type="button" class="close geo-selector-localized-copy" data-dismiss="modal" aria-label="Close dialog window" lang="en"></button>
```

Note that mixing languages within a single element is not accessible. For example:

```html
<a href="#" class="btn btn-primary btn-block" hreflang="en">Accéder au Canada - English</a>
```

This is not accessible because the langauge changes in the middle of the text node. This would not narrate correctly. Also while the following example does narrate correctly...

```html
<a href="#" class="btn btn-primary btn-block" hreflang="ar">Go to <span lang="ar">الأردن - العربية</span></a>
```

... it is not recommended because it assumes the user can read both languages.

### `hreflang` Attributes

```html
<a href="#" class="btn btn-primary btn-block" lang="en" hreflang="en">Go to Canada - English</a>
...
<a href="#" class="btn btn-primary btn-block" hreflang="en">Accéder au Canada - Anglais</a>
```

When a link points to a site that is in a different language than the current page, it is important for accessibility reasons to indicate it using the `hreflang` attribute. In a dual-language Geo Selector, there will be two such links, the Leave Link in the current page language, and the Leave link in the detected language. Both must marked with `hreflang`. In the above example, since the links point from a French page to an English page, both links are marked with `hreflang="en"`

### `dir` Attributes

If the Geo Selector contains languages that write in different directions, for example English and Arabic, all elements that write in a direction that differs from the current page must be marked with the `dir` attribute as follows:

```html
<div class="geo-selector-localized-copy"><p lang="en" dir="ltr">Do you want to browse in Canada - English?</p></div>
<div class="geo-selector-localized-copy" hidden><p>هل تبحث عن Microsoft Store بـ: كندا - الإنجليزية؟</p></div>
```

In the above example, English is being displayed on a page is in Arabic, so it marked with both `lang="en"` and `dir="ltr"`. For reference, the following is a full example of a dual-language Geo Selector on an Arabic page where English was detected.

```html
<div class="modal fade" id="geo-selector-modal" tabindex="-1" role="dialog" aria-labelledby="modal-label-id" aria-hidden="true">
  <div class="modal-dialog  modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close geo-selector-localized-copy" data-dismiss="modal" aria-label="Close dialog window" lang="en" dir="ltr"></button>
        <button type="button" class="close geo-selector-localized-copy" data-dismiss="modal" aria-label="إلغاء" hidden></button> </div>
      <div class="modal-body">
        <button data-mount="content-swap" data-target=".geo-selector-localized-copy" class="action-trigger mb-2">
          <span class="geo-selector-localized-copy">ترجمة إلى العربية</span>
          <span class="geo-selector-localized-copy" hidden lang="en" dir="ltr">Translate to English</span>
        </button>
        <h2 class="h3" id="modal-label-id">
          <span class="geo-selector-localized-copy" lang="en" dir="ltr">You are visiting the Microsoft Store in Jordan - Arabic</span>
          <span class="geo-selector-localized-copy" hidden>أنت تتسوق في Microsoft Store بـ: الأردن - العربية</span>
        </h2>
        <div class="geo-selector-localized-copy">
          <p lang="en" dir="ltr">Do you want to browse in Canada - English?</p>
        </div>
        <div class="geo-selector-localized-copy" hidden>
          <p>هل تبحث عن Microsoft Store بـ: كندا - الإنجليزية؟</p>
        </div>
      </div>
      <div class="modal-footer pb-5">
        <div class="container px-0 w-100">
          <div class="row geo-selector-localized-copy">
            <div class="col-12 col-md-6 mb-3">
              <button class="btn btn-primary btn-block" data-dismiss="modal" lang="en" dir="ltr">Stay in Jordan - Arabic</button>
            </div>
            <div class="col-12 col-md-6 mb-3">
              <a href="#" class="btn btn-primary btn-block" lang="en" hreflang="en" dir="ltr">Go to Canada - English</a>
            </div>
          </div>
          <div class="row geo-selector-localized-copy" hidden>
            <div class="col-12 col-md-6 mb-3">
              <button class="btn btn-primary btn-block" data-dismiss="modal">البقاء بـ الأردن - العربية</button>
            </div>
            <div class="col-12 col-md-6 mb-3">
              <a href="#" class="btn btn-primary btn-block" hreflang="en">الانتقال إلى كندا - الإنجليزية</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
```
