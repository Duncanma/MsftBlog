{{#> @modal this}}
{{#*inline 'body-partial'}}
  <h2 class="base font-weight-normal mb-3" id="{{aria-labelledby-id}}">{{product-name}}</h2>
  {{#if demo}}
    {{!-- For demonstration only --}}
    {{setVar 'rate-wrapper' 'rate-a-product-content--rate'}}
    {{setVar 'review-wrapper' 'rate-a-product-content--review'}}
    {{setVar 'confirmation-wrapper' 'rate-a-product-content--confirmation'}}
    <div id="{{getVar 'rate-wrapper'}}">
      {{render '@rate-a-product-content--rate'}}
    </div>
    <div id="{{getVar 'review-wrapper'}}">
      {{render '@rate-a-product-content--review'}}
    </div>
    <div id="{{getVar 'confirmation-wrapper'}}">
      {{render '@rate-a-product-content--confirmation'}}
    </div>
  {{else}}
    {{render (lookup . 'template') merge=true}}
  {{/if}}
{{/inline}}
{{/@modal}}

{{#ifCond demo '||' needs-init}}
{{!-- For demonstration only --}}
<script>
  window.onload = function () {
    var modalContainer = document.getElementById('{{../id}}');
    {{#if ../needs-init}}
    var rateModal = new mwf.Modal({
      modal: modalContainer
    });
    rateModal.show();
    {{/if}}

    {{#if ../demo}}
    var rateWrapper = document.getElementById("{{ getVar 'rate-wrapper'}}");
    var reviewWrapper = document.getElementById("{{ getVar 'review-wrapper'}}");
    var confirmWrapper = document.getElementById("{{ getVar 'confirmation-wrapper'}}");
    
    reviewWrapper.style.display = 'none';
    confirmWrapper.style.display = 'none';

    document.getElementById('add-a-review-btn').onclick = function (e) {
      e.preventDefault();
      rateWrapper.style.display = 'none';
      reviewWrapper.style.display = 'block';
      modalContainer.focus();
    };

    document.getElementById('go-back-btn').onclick = function (e) {
      e.preventDefault();
      rateWrapper.style.display = 'block';
      reviewWrapper.style.display = 'none';
      modalContainer.focus();
    };
    
    var contentModal = document.querySelector('#rate-a-product-content--review form');
    contentModal.addEventListener('onValid', function(e) {
      e.preventDefault();
      reviewWrapper.style.display = 'none';
      confirmWrapper.style.display = 'block';
      modalContainer.focus();
    });
    
    var rateModal = document.querySelector('#rate-a-product-content--rate form');
    rateModal.addEventListener('onValid', function(e) {
      e.preventDefault();
      rateWrapper.style.display = 'none';
      confirmWrapper.style.display = 'block';
      modalContainer.focus();
    });
    {{/if}}
  }
</script>
{{/ifCond}}
