{{setProp this 'foreground' (evaluate foreground '||' (object))}}
{{setVar 'foregroundClasses' (array)}}
{{setVar 'cardClasses' (array 'material-md-card')}}

{{#if color-scheme}}
  {{push (getVar 'foregroundClasses') (strConcat 'bg-md-transparent bg-' color-scheme)}}
  {{push (getVar 'cardClasses') (strConcat 'material-color-' color-scheme)}}
  {{setProp card.body.templates.[0].data 'color-scheme' color-scheme}}
{{/if}}
{{#if (evaluate vertical-alignment '==' 'top')}}
  {{push (getVar 'foregroundClasses') 'align-self-start'}}
{{/if}}
{{#if (evaluate vertical-alignment '==' 'bottom')}}
  {{push (getVar 'foregroundClasses') 'align-self-end'}}
{{/if}}
{{#if foreground.display-classes}}
  {{push (getVar 'foregroundClasses') foreground.display-classes}}
{{/if}}
{{#if transparent-card}}
  {{push (getVar 'cardClasses') (strConcat 'depth-lg-none bg-lg-transparent-text-' transparent-card)}}
{{/if}}
{{#if carousel}}
  {{push (getVar 'cardClasses') 'px-g px-md-5 pt-4 pb-3 py-md-5'}}
{{else}}
  {{push (getVar 'cardClasses') 'py-5 px-md-5'}}
{{/if}}

{{#if foreground.classes}}
  {{#unless (contains foreground.classes (join (getVar 'foregroundClasses') ' '))}}
    {{push (getVar 'foregroundClasses') foreground.classes}}
  {{/unless}}
  {{#unless (contains foreground.classes (join (getVar 'foregroundClasses') ' '))}}
    {{setProp foreground 'classes' (join (getVar 'foregroundClasses') ' ')}}
  {{/unless}}
{{else}}
  {{setProp foreground 'classes' (join (getVar 'foregroundClasses') ' ')}}
{{/if}}
{{#if card.classes}}
  {{#unless (contains card.classes (join (getVar 'cardClasses') ' '))}}
    {{push (getVar 'cardClasses') card.classes}}
  {{/unless}}
  {{#unless (contains card.classes (join (getVar 'cardClasses') ' '))}}
    {{setProp card 'classes' (join (getVar 'cardClasses') ' ')}}
  {{/unless}}
{{else}}
  {{setProp card 'classes' (join (getVar 'cardClasses') ' ')}}
{{/if}}

{{#> '@card-image-overlay'}}
<div class="container">
  <div class="d-flex mt-md-n5 my-lg-5
    {{~#if (evaluate alignment '==' "right")}} justify-content-end{{/if~}}
    {{~#if (evaluate alignment '==' "center")}} justify-content-center{{/if~}}">
    <div class="w-100 {{#if card.small}}w-lg-col-4{{else}}w-lg-col-5{{/if}}">
      {{render '@card' card}}
    </div>
  </div>
</div>
{{/'@card-image-overlay'}}