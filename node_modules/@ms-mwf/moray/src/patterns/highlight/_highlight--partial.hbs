{{setProp this 'foreground' (evaluate foreground '||' (object))}}
{{setProp this 'wrapper' (evaluate wrapper '||' (object))}}
{{setVar 'foregroundClasses' (array 'mt-md-n5 my-lg-5 px-g px-lg-0')}}
{{setVar 'cardClasses' (array 'material-md-card')}}

{{#if color-scheme}}
  {{push (getVar 'foregroundClasses') (strConcat 'bg-md-transparent bg-' color-scheme)}}
  {{push (getVar 'cardClasses') (strConcat 'material-color-' color-scheme)}}
  {{setProp card.body.templates.[0].data 'color-scheme' color-scheme}}
{{/if}}
{{#if (evaluate alignment '==' 'right')}}
  {{push (getVar 'foregroundClasses') 'justify-content-end'}}
{{/if}}
{{#if (evaluate alignment '==' 'center')}}
  {{push (getVar 'foregroundClasses') 'justify-content-center'}}
{{/if}}
{{#if (evaluate vertical-alignment '==' 'top')}}
  {{push (getVar 'foregroundClasses') 'align-self-start'}}
{{/if}}
{{#if (evaluate vertical-alignment '==' 'bottom')}}
  {{push (getVar 'foregroundClasses') 'align-self-end'}}
{{/if}}
{{#if foreground.display-classes}}
  {{push (getVar 'foregroundClasses') foreground.display-classes}}
{{else}}
  {{push (getVar 'foregroundClasses') 'd-flex'}}
{{/if}}
{{#if transparent-card}}
  {{push (getVar 'cardClasses') (strConcat 'depth-lg-none bg-lg-transparent-text-' transparent-card)}}
{{/if}}
{{#if carousel}}
  {{push (getVar 'cardClasses') 'px-g px-md-5 px-lg-4'}}
  {{setProp card.body 'classes' 'py-4 py-md-5 py-lg-4'}}
{{else}}
  {{push (getVar 'cardClasses') 'py-5 px-md-5'}}
  {{#if wrapper.classes}}
    {{setVar 'wrapperClasses' (array 'mx-ng mx-lg-0')}}
    {{#unless (contains wrapper.classes (join (getVar 'wrapperClasses') ' '))}}
      {{push (getVar 'wrapperClasses') wrapper.classes}}
      {{setProp wrapper 'classes' (join (getVar 'wrapperClasses') ' ')}}
    {{/unless}}
  {{else}}
    {{setProp wrapper 'classes' 'mx-ng mx-lg-0'}}
  {{/if}}
{{/if}}

{{#if foreground.classes}}
  {{#unless (contains foreground.classes (join (getVar 'foregroundClasses') ' '))}}
    {{push (getVar 'foregroundClasses') foreground.classes}}
  {{/unless}}
  {{#unless (contains foreground.classes (join (getVar 'foregroundClasses') ' '))}}
    {{setProp foreground 'classes' (join (getVar 'foregroundClasses') ' ')}}
  {{/unless}}
{{else}}
  {{setProp foreground 'classes' (join (getVar 'foregroundClasses') ' ')}}
{{/if}}
{{#if card.classes}}
  {{#unless (contains card.classes (join (getVar 'cardClasses') ' '))}}
    {{push (getVar 'cardClasses') card.classes}}
  {{/unless}}
  {{#unless (contains card.classes (join (getVar 'cardClasses') ' '))}}
    {{setProp card 'classes' (join (getVar 'cardClasses') ' ')}}
  {{/unless}}
{{else}}
  {{setProp card 'classes' (join (getVar 'cardClasses') ' ')}}
{{/if}}

{{#> '@card-image-overlay'}}
<div class="w-100 {{#if card.small}}w-lg-col-4{{else}}w-lg-col-5{{/if}} mx-lg-5">
  {{render '@card' card}}
</div>
{{/'@card-image-overlay'}}
