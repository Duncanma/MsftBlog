@import "../../styles/functions";
@import "../../variables";
@import "../../styles/mixins";
@import "mixins";

//
// Accessibility
//

.tab-group,
.tab-arrows {
  // allow all tabs/arrows to be focusable (even tabindex="-1")
  [tabindex]:focus {
    /* stylelint-disable-next-line declaration-no-important */
    outline: $vfi-outline-width $vfi-outline-style currentColor !important;
    z-index: 2;
  }
}

// Tab Panels
//
// Hide tabbable panes to start, show them when `.active`
// .tab-content is an older alias, likely still in use

.tab-content,
.tab-panel-group {
  margin-top: $tab-panel-group-margin-top;

  > .tab-pane,
  > .tab-panel {
    // .tab-pane is an older alias, likely still in use
    display: none;
  }
  > .active {
    display: block;
  }
}

//
// Tab List
//

.tab-overflow {
  overflow-x: scroll;
  overflow-y: hidden;
  scrollbar-width: none;
  -ms-overflow-style: none;
  &::-webkit-scrollbar {
    display: none;
  }
}

.tab-group {
  display: flex;
  flex-wrap: nowrap;
  position: relative;
  z-index: 0;

  @include horizontal-tabs {
    border-bottom-width: $tab-border-width;
    border-bottom-style: solid;
    border-color: $tab-text-default-color;

    @include theme-inverse {
      border-color: $tab-text-default-color-inverse;
    }
  }

  @include underline-tabs {
    border-bottom: $tab-underline-border-bottom solid $tab-underline-border-bottom-color;

    @include theme-inverse {
      border-bottom: $tab-underline-border-bottom solid $tab-underline-border-bottom-color-inverse;
    }
  }

  a,
  button {
    flex: 0 0 auto;

    span {
      @include outline-tabs {
        max-width: $tab-outline-max-width;
        line-height: 1.25;
      }
    }
  }

  a:not(.tab-image),
  button:not(.tab-image) {
    color: $tab-text-default-color;
    border-style: solid;
    border-width: $tab-border-width;
    font-weight: $font-weight-semibold;
    text-decoration: none;

    @include theme-inverse {
      color: $tab-text-default-color-inverse;
    }

    @include horizontal-tabs {
      border-top-left-radius: $tab-border-radius;
      border-top-right-radius: $tab-border-radius;
      border-bottom: none;
      padding: $tab-padding-y $tab-padding-x;

      @include ltr {
        &:not(:first-child) {
          margin-left: -$tab-border-width;
        }
      }
      @include rtl {
        &:not(:last-child) {
          margin-left: -$tab-border-width;
        }
      }
    }

    @include underline-tabs {
      border: $transparent;
      border-bottom: $tab-underline-border-bottom $transparent solid;
      border-radius: $tab-underline-border-radius $tab-underline-border-radius 0 0;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: $tab-underline-padding-y $tab-underline-padding-x;
      margin: 0 $tab-underline-margin-x;

      span {
        max-width: $tab-underline-max-width;
      }

      &::before {
        @include ltr {
          margin-right: $tab-underline-margin-glyph;
        }
        @include rtl {
          margin-left: $tab-underline-margin-glyph;
        }
      }
    }

    @include outline-tabs {
      display: flex;
      align-items: center;
      position: relative;
      padding: $tab-outline-padding-y $tab-padding-x;
      border-radius: $tab-outline-border-radius;

      &::after {
        content: "";
        position: absolute;
        width: 100%;
        height: calc(100% + #{$tab-border-width} * 2);
        top: 50%;
        transform: translateY(-50%);
        z-index: -1;
        background: $tab-outline-bg-default-color;

        @include theme-inverse {
          background: $tab-outline-bg-default-color-inverse;
        }

        @include ltr {
          right: calc((#{$tab-outline-border-radius} / 2 + 0.35rem) * -1);
        }

        @include rtl {
          left: calc((#{$tab-outline-border-radius} / 2 + 0.35rem) * -1);
        }
      }

      &:last-child::after {
        content: none;
      }
    }

    &:not(.active) {
      transition: all $tab-hover-duration ease-in-out;

      @include horizontal-tabs {
        background: $tab-bg-default-color;
        border-color: $tab-border-default-color;
        margin-top: $tab-margin-y;

        @include theme-inverse {
          background: $tab-bg-default-color-inverse;
          border-color: $tab-border-default-color-inverse;
        }

      }

      @include underline-tabs {
        color: $tab-underline-text-color;

        @include theme-inverse {
          color: $tab-underline-text-color-inverse;
        }
      }

      @include outline-tabs {
        background: $tab-outline-bg-default-color;
        border-color: $tab-outline-bg-default-color;

        @include theme-inverse {
          background: $tab-outline-bg-default-color-inverse;
          border-color: $tab-outline-bg-default-color-inverse;
        }
      }

      &:hover,
      &:focus {
        color: $tab-text-default-active-color;

        @include theme-inverse {
          color: $tab-text-default-active-color-inverse;
        }

        @include horizontal-tabs {
          margin-top: 0;
          padding-top: $tab-text-active-padding-y;
        }
      }
    }

    &:hover,
    &:focus {
      @include underline-tabs {
        background: $tab-underline-bg;
        color: $tab-underline-text-color-active;

        @include theme-inverse {
          background: $tab-underline-bg-inverse;
          color: $tab-underline-text-color-active-inverse;
        }
      }

      @include outline-tabs {
        z-index: auto; //keep ::after elements in correct stacking order
      }
    }

    // style tab VFI inset like buttons
    &:focus {
      outline-offset: $vfi-outline-inset;

      @include underline-tabs {
        outline-offset: -$tab-underline-outline-offset;
      }
    }
  }

  .glyph-prepend::before {
    vertical-align: text-bottom;

    @include outline-tabs {
      padding-top: $tab-text-active-padding-x;

      @include ltr {
        padding-right: $tab-padding-y;
      }

      @include rtl {
        padding-left: $tab-padding-y;
      }
    }
  }

  .active:not(.tab-image) {
    border-color: $tab-text-default-color;
    color: $tab-text-default-active-color;
    z-index: 1;

    @include theme-inverse {
      border-color: $tab-text-default-color-inverse;
      color: $tab-text-default-active-color-inverse;
    }

    @include horizontal-tabs {
      background: $tab-bg-default-active-color;
      padding-top: $tab-text-active-padding-y;
      margin-bottom: -$tab-border-width;

      @include theme-inverse {
        background: $tab-bg-default-active-color-inverse;
      }
    }

    @include underline-tabs {
      color: $tab-underline-text-color-active;

      @include theme-inverse {
        color: $tab-underline-text-color-active-inverse;
      }

      &::after {
        content: "";
        position: absolute;
        width: 100%;
        height: $tab-underline-height;
        bottom: -$tab-underline-position-bottom;
        left: 0;
        right: 0;
        border-radius: $tab-underline-border-radius-active $tab-underline-border-radius-active 0 0;
        background: $tab-underline-theme-color;

        @include theme-inverse {
          background: $tab-underline-theme-color-inverse;
        }
      }
    }

    @include outline-tabs {
      padding: $tab-outline-padding-y $input-btn-padding-x;
      z-index: auto;
      background-color: $tab-bg-default-active-color;
      border-color: $tab-primary-default-color;

      @include theme-inverse {
        background-color: $tab-bg-default-active-color-inverse;
        border-color: $tab-primary-default-color-inverse;
      }
    }

    @media screen and (-ms-high-contrast: black-on-white) {
      background: $black;
      border-color: $white;
      color: $white;
    }

    @media screen and (-ms-high-contrast: white-on-black) {
      background: $white;
      border-color: $black;
      color: $black;
    }
  }
}

//
// Tab Primary Color
//

.tab-primary {
  .tab-group {
    border-color: $tab-primary-default-color;

    @include theme-inverse {
      border-color: $tab-primary-default-color-inverse;
    }

    a:not(.tab-image),
    button:not(.tab-image) {
      color: $tab-primary-default-color;

      @include theme-inverse {
        color: $tab-primary-default-color-inverse;
      }

      &:not(.active) {
        border-color: $tab-bg-primary-hover-color;
        background: $tab-bg-primary-default-color;

        @include theme-inverse {
          border-color: $tab-bg-primary-hover-color-inverse;
          background: $tab-bg-primary-default-color-inverse;
        }
      }
    }

    .active {
      border-color: $tab-primary-default-color;

      @include theme-inverse {
        border-color: $tab-primary-default-color-inverse;
      }
    }
  }
}

//
// Tab Slider Arrows
//

.tab-arrows {
  display: none;

  .arrow-prev,
  .arrow-next {
    color: $tab-text-default-active-color;
    position: absolute;
    height: 100%;
    top: 0;
    padding: 0 $tab-arrow-padding-x;
    border: none;
    transition: all $tab-hover-duration ease-in-out;
    z-index: 2;

    @include theme-inverse {
      color: $tab-text-default-active-color-inverse;
    }

    @include horizontal-tabs {
      height: (calc(100% - #{$tab-border-width}));
      padding: $tab-padding-x $tab-arrow-padding-x $tab-padding-y $tab-arrow-padding-x;
    }

    &::after {
      font-family: $font-family-glyph;
      font-size: $glyph-size-medium;
      @include transition($transition-transform);
      color: inherit;
    }
  }

  .arrow-prev {
    left: $tab-padding-x;
    background: linear-gradient(to right, $tab-bg-default-active-color 75%, rgba($tab-bg-default-active-color, 0));

    @include theme-inverse {
      background: linear-gradient(to right, $tab-bg-default-active-color-inverse 75%, rgba($tab-bg-default-active-color-inverse, 0));
    }

    &::after {
      content: map-get($glyphs, "chevron-left");
    }

    &:hover,
    &:focus {
      transform: translate(-0.25rem, 0);
    }
  }

  .arrow-next {
    background: linear-gradient(to left, $tab-bg-default-active-color 75%, rgba($tab-bg-default-active-color, 0));
    right: $tab-padding-x;

    @include theme-inverse {
      background: linear-gradient(to left, $tab-bg-default-active-color-inverse 75%, rgba($tab-bg-default-active-color-inverse, 0));
    }

    &::after {
      content: map-get($glyphs, "chevron-right");
    }

    &:hover,
    &:focus {
      transform: translate(0.25rem, 0);
    }
  }

  &.mobile-arrows {
    .arrow-prev {
      background: linear-gradient(to right, $tab-bg-default-active-color 5%, rgba($tab-bg-default-active-color, 0));

      @include theme-inverse {
        background: linear-gradient(to right, $tab-bg-default-active-color-inverse 5%, rgba($tab-bg-default-active-color-inverse, 0));
      }
    }

    .arrow-next {
      background: linear-gradient(to left, $tab-bg-default-active-color 5%, rgba($tab-bg-default-active-color, 0));

      @include theme-inverse {
        background: linear-gradient(to left, $tab-bg-default-active-color-inverse 5%, rgba($tab-bg-default-active-color-inverse, 0));
      }
    }

    .arrow-prev,
    .arrow-next {
      pointer-events: none;
      &::after {
        color: $transparent;
      }
    }
  }
}

// chevron size modifier
.tab-arrows-lg {
  .arrow-prev,
  .arrow-next {
    padding: $tab-arrow-padding-lg;

    &::after {
      font-size: $glyph-size-large;
    }
  }
}
