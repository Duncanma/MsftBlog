{{setVar 'id' (evaluate id '||' (uid))}}
{{setProp this 'close' (evaluate header.close '||' (object aria-label="Close dialog window"))}}
{{setProp close 'attributes' (evaluate header.close.attributes '||' (object))}}
{{setProp close.attributes 'data-dismiss' 'modal'}}

{{#if button}}
  <button type="button" class="btn btn-primary" data-target="#{{getVar 'id'}}">
    {{~label~}}
  </button>
{{/if}}
{{!-- Hardcoded aria-label value of "Placeholder for explicit label" when aria-labelledby or aria-label are not provided based on a11y guideance (see bug #4733) --}}
<div data-mount="modal" class="modal fade" id="{{getVar 'id'}}" tabindex="-1" role="dialog"{{#if title}} aria-labelledby="{{aria-labelledby-id}}"{{else}} aria-label="{{#if aria-label}}{{aria-label}}{{else}}Placeholder for explicit label{{/if}}"{{/if}} aria-hidden="true" {{{htmlAttr attributes}}}>
  <div class="modal-dialog {{#if size}} modal-{{size}} {{/if}}{{#ifCond type "==" "scrollable" }} modal-dialog-scrollable{{/ifCond}}" role="document">
    {{~setVar 'contentTag' (evaluate content.html-tag '||' 'div')}}
    <{{getVar 'contentTag'}} class="modal-content" {{{htmlAttr content.attributes}}}>
      {{!-- See comments in transitionComplete function for evaluating tabindex -1 --}}
      <div class="modal-header {{header.classes}}" {{#if (evaluate (evaluate type "==" "scrollable") '&&' title) }} tabindex="-1"{{/if}}>
        {{#if title}}
          <h2 class="modal-title h6" id="{{aria-labelledby-id}}">{{title}}</h2>
        {{/if}}
        {{render '@close' close merge=true}}
        {{#> header-partial}}
        {{/header-partial~}}
      </div>
      <div class="modal-body {{body.classes}}">
        {{#> body-partial}}
          {{#if body}}
            {{#each body}}
              {{{this}}}
            {{/each}}
          {{/if}}
          {{#each body-templates}}
            {{render (strConcat '@' name) data merge=true}}
          {{/each}}
        {{/body-partial}}
      </div>
      {{#if footer}}
      <div class="modal-footer {{footer.classes}}">
        {{#> footer-partial}}
          {{#if footer.content}}
            {{{footer.content}}}
          {{/if}}
        {{/footer-partial}}
      </div>
      {{/if}}
    </{{getVar 'contentTag'}}>
  </div>
</div>
<!-- For Demonstration ONLY, do NOT use in production -->
<script>
  window.onload = function() {
    try {
      document.querySelector('body').insertAdjacentElement('afterbegin', document.querySelector('#{{getVar "id"}}'));
    } catch (e) {
      // Fail gracefully
    }
  }
</script>
