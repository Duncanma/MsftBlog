# Moray
A Microsoft web UI framework. Based on Bootstrap 4, extended for Microsoft marketing needs.

## Get started
1. Install [Node.js](https://nodejs.org/en/). We recommend the LTS version, or at least Node.js `14.17.0` and npm `7.14.0`.
   Windows users may need to follow these additional steps:
   - delete chocolatey (https://docs.chocolatey.org/en-us/choco/uninstallation)
   - reinstall node, make sure to check "Automatically install all necessary tools" checkbox
   - install visual studio 2019 with build tools for C++
   - make sure you have correct system32 path in the env variable PATH
2. Add Moray npm feed credentials to your user `.npmrc` file
    - Navigate to [Moray package feed](https://mscomdev.visualstudio.com/Moray/_packaging?_a=feed&feed=Moray)
    - Click the "Connect to feed" button and follow the instructions in the npm tab
3. Ensure you are on the correct branch
    - **Contributors** should be on the current development branch by running `git checkout release`
    - **Consumers** should utilize git tags to view the appropriate snapshot of code from a particular version release. For example, to view the repository at version 1.0.0 run `git checkout v1.0.0`.
4. Install npm dependencies with `npm install`
5. Build the framework and run the local dev server at [localhost:9001](http://localhost:9001)
    - `npm run dev`

### Troubleshooting installation
Some users encounter npm issues typically caused by formatting issues in `.npmrc` files, incorrect registry addresses, or bad authentication tokens. All issues can result in `404` errors, with some authentication issues resulting in `403` or `401` errors. Review the checklist below if you are encountering the above errors.

- Both Node.js and npm are installed and up-to-date
- For Windows users, ensure the "Automatically install necessary tools" checkbox was checked on Setup through the Node.js installer
- The private registry address is in an `.npmrc` file located in your project's root directory with your `package.json`
- The private registry address is formatted correctly
    - `always-auth=true` must be on a separate line from the registry address
    - **Consumers** should add the `@ms-mwf:` scope in front of the registry address
    - The registry address must not contain any "feed views" such as `@local`, `@Prerelease`, or `@Release`
- The credentials are in the `.npmrc` of your user directory, ***not*** in the project's `.npmrc`
- The credentials are complete including all lines between `; begin auth token` and `; end auth token` (this may look different for Windows users using `vsts-npm-auth`)
- The access token is base64 encoded and formatted correctly, e.g. `_password=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx==`
- The access token is not expired and has at minimum read privileges; write privileges will be necessary for contributing


## Generate new Fractal component files
1. Windows users will need to install a bash shell
    - [Windows Subsystem for Linux](https://docs.microsoft.com/en-us/windows/wsl/install-win10)
    - [start bash shell](https://docs.microsoft.com/en-us/windows/wsl/reference#bashexe)
2. To make script executable, run `chmod +x new-component.sh`
3. Run the script:
    - Windows: `.\new-component.sh`
    - OS X: `./new-component.sh`