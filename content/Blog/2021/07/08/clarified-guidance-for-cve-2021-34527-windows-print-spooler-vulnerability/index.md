---
title: 'Clarified Guidance for CVE-2021-34527 Windows Print Spooler Vulnerability'
description: ""
published: 2021-07-08
type: posts
redirect_from:
            - https://msrc-blog.microsoft.com/2021/07/08/clarified-guidance-for-cve-2021-34527-windows-print-spooler-vulnerability/
authors:
- simon.pope
categories:
- MSRC
---
On Tuesday July 6, 2021, Microsoft issued CVE-2021-34527 regarding a Windows Print Spooler vulnerability. Updates were released on July 6 and 7 which addressed the vulnerability for all supported Windows versions. We encourage customers to update as soon as possible.

[CVE-2021-34527 - Windows Print Spooler Remote Code Execution Vulnerability](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527).

Following the out of band release (OOB) we investigated claims regarding the effectiveness of the security update and questions around the suggested mitigations.

**Our investigation has shown that the OOB security update is working as designed and is effective against the known printer spooling exploits and other public reports collectively being referred to as PrintNightmare. All reports we have investigated have relied on the changing of default registry setting related to Point and Print **to an insecure configuration**.**

Microsoft has focused its efforts on making customer protections available as quickly as possible and our guidance has been updated as our understanding of the issue has evolved. We recommend that customer follow these steps immediately:

- In ALL cases, apply the CVE-2021-34527 security update. The update will not change existing registry settings

- After applying the security update, review the registry settings documented in the CVE-2021-34527 advisory

- If the registry keys documented do not exist, no further action is required

- If the registry keys documented exist, in order to secure your system, you must confirm that the following registry keys are set to 0 (zero) or are not present:

  - HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\PointAndPrint
  - NoWarningNoElevationOnInstall = 0 (DWORD) or not defined (default setting)
  - UpdatePromptSettings = 0 (DWORD) or not defined (default setting)

For more in depth guidance, please see [KB5005010: Restricting installation of new printer drivers after applying the July 6, 2021 updates](https://support.microsoft.com/en-us/topic/kb5005010-restricting-installation-of-new-printer-drivers-after-applying-the-july-6-2021-updates-31b91c02-05bc-4ada-a7ea-183b129578a7) and [CVE-2021-34527](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527).

If our investigation identifies additional issues, we will take action as needed to help protect customers.

The MSRC Team
